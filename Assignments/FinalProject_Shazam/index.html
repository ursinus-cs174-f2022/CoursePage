<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<!-- Header !-->
	<head>
		<title>Ursinus CS 174: Object Oriented Programming,Spring 2022</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<!--[if lte IE 8]><script src="../../assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="../../assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="../../assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="../../assets/css/ie8.css" /><![endif]-->
        <style>
        .image_off, #home:hover .image_on{
           display:none
        }
        .image_on, #home:hover .image_off{
           display:block
        }
        </style>
	</head>
	<body>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="../../index.html" class="logo"><strong>Ursinus CS 174: Object Oriented Programming, Spring 2022</strong></a>
								</header>
<!-- End Header !-->

							<!-- Content -->
								<section>
									<header class="main">
                                        <h2>Final Project: The Shazam Algorithm for Audio Fingerprinting (100 Points)</h2>
										<h3><a href = "https://www.ctralie.com">Chris Tralie</a></h3>
									</header>

									<div id="page-content">

                                        
										<ul>
											<li><a href = "#overview">Overview/Logistics</a>
												<ul>
												</ul>
											</li>
											
										</ul>

										<p>
											Documentation for SimpleCanvas can be found at <a href = "https://ursinus-cs174-s2022.github.io/simplecanvas/docs/html/classSimpleCanvas.html">this link</a>.
										</p>

										<p>
											Full database can be found at <a href = "https://drive.google.com/file/d/1rjcIW81FpMMnik0P4o8W6HWZqL420ShB/view?usp=sharing">this link</a>
										</p>
										

                                        <h2><a name = "overview">Overview / Logistics</a></h2>
										<p>
                                            We have now reached the climax of the course!  This assignment is a direct followup to the <a href = "../HW5_BasketballHashing/">last assignment on basketball hashing</a>.  Now that we have a hash table implementation, we're going to use it for an even more exciting task of quickly identifying a song from a short (and possibly degraded) audio clip of that song.  We will be implementing the so-called "<a href = "https://en.wikipedia.org/wiki/Shazam_(application)">Shazam</a> algorithm," which you can read more about in <a href = "Wang03-shazam.pdf">this paper</a>, and which I have broken down with audio examples at <a href = "background.html">this link</a>.  In a nutshell, we will be building something called an <b>audio fingerprint</b>, which can be used to identify songs from short clips of audio.
                                        </p>

										<h4>The Design Is Yours!</h4>
										<p>
											I am giving you the freedom to design the code any way you want in this assignment, so you should take some time to plan out what you're going to do before you start coding.  Think about what classes you're going to write, what entry point programs with mains you'll write to run your code, and how everything will fit together.  Your code should be <b>modular</b>, <b>reusable</b>, and <b>well encapsulated</b>.
										</p>

                                        <p>
                                            <h3>Summative Learning Objectives</h3>
                                            <ul>
												<li>Design and implement code that uses object oriented principles</li>
                                                <li>Use multiple classes together in concert to accomplish a task</li>
												<li>Use hash tables to organize and find data quickly</li>
												<li>Manipulate 2D arrays in C++</li>
												<li>Manage dynamic memory and object references in C++</li>
												<li>Implement audio features for content-based music information retrieval</li>
                                            </ul>
										</p>

										<h3>
											Background
										</h3>
										<p>
											<a href = "background.html">Click here</a> to view background notes on the algorithm you will be implementing.
										</p>
										
										<p>
											<h3><a name = "code">Starter Code</a></h3>
											<a href = "https://github.com/Ursinus-CS174-F2020/HW5b_Shazam/archive/main.zip">Click here</a> to download the starter code for this assignment.  You will be filling in code in the <code>fingerprint.cpp</code> file.  You'll notice that it shares a lot of code with the previous assignment, and it has a makefile to manage building all of the little files.  <b>The very first think you should do <u>before</u> you type <code>make</code> is to copy in your working <code>hashtable.cpp</code> from last assignment</b>.  If this worked, your code should build, and you should be able to generate the example spectrogram in the <a href = "#spectrograms">next section</a>.  Please do not proceed until that is working!
										</p>


                                        <h3><a name = "readme">What to submit</a></h3>
                                            <p>
												When you are finished, please submit a .zip file with your code (not including the database) to canvas, as well as a README file explaining a brief overview of your code files and the design decisions you made
											</p>


										

										<h3>Code to write</h3>
										<p>
											To implement the above technique in code, you'll be filling in the method <code>queryDatabase</code> in <code>fingerprint.cpp</code>, which is an instance method of a <code>SongData</code> containing the fingerprints of a query song (which are accessible via <code>fingerprints</code> instance variable).  The method takes in a list of songs in the database of type <code>songInfo</code>, which is simply a wrapper around a string for the title and artist of a song in the database.  It also takes in a hash table whose keys are <code>Fingerprint</code> objects and whose values are references to type <code>FingerprintList</code>.  A <code>FingerprintList</code> object wraps around a vector containing objects of type <code>fingerprintInfo</code>, which contains a list with information about every copy of that exact fingerprint that was seen <i>across all songs in the database</i>.  A <code>fingerprintInfo</code> object has a number of fields, and you will need to focus on these two:
											<ul>
												<li>
													<code>offset</code>: The time window index of the first anchor in the fingerprint
												</li>
												<li>
													<code>index</code>: The index of the song to which it belongs, in the array of songs in the database
												</li>
											</ul>
										</p>
										<p>
											To find a candidate match, you should loop through all of the fingerprints in the query song.  For each query fingerprint, you should look at all matching copies of this fingerprint in the database, which you can get as the value of the fingerprint key in the HashTable <code>db</code>.  For each of these matches, you should add one to the corresponding song's histogram at a bin which is the difference between the song's fingerprint offset and window of the query's first anchor.  It is possible to do this with an array, but an easier way to implement a histogram is as a HashMap whose keys and values are both <code>HashableInt</code> objects, where the key is the bin index and the value is the count.  Since you'll need a histogram for every song in the database, the code comes setup with an array of such hash maps.  You should fill in those hash maps and keep track of the song corresponding to the maximum count as you go along, as you will eventually return this song as the candidate match.
										</p>

										<h3>Testing</h3>
										<p>
											To see if this works correctly, you can run the file <code>query</code>
										</p>

										<script type="syntaxhighlighter" class="brush: cpp">./query -audio ExampleQueries/wangchungClean.wav
										</script>

										which will then output something like the following

										<script type="syntaxhighlighter" class="brush: cpp">
											Getting spectrogram...
											Finished getting spectrogram
											0 seconds elapsed processing query audio
											Loading Kanye West: Touch the Sky
											Loading Wang Chung: Everybody Have Fun Tonight
											Loading Daniel Powter: Bad Day
											Loading Transplants: California Babylon
											Loading Bananarama: Cruel Summer
											Loading Jeff Kashiwa: Ooh Ah
											0 seconds elapsed loading database
											Wang Chung: Everybody Have Fun Tonight
											0 seconds elapsed performing query
										</script>

										<p>
											So it's correctly found that the song is "Wang Chung: Everybody Have Fun Tonight."  Your program should also print out that song for the following two inputs
										</p>

										<table>
											<tr>
												<td>
													<h4>
														ExampleQueries/wangchungLaptop.wav
													</h4>
													</td>
												<td>
													<audio controls>
														<source src="HW5b_Shazam/ExampleQueries/wangchungLaptop.wav" type="audio/ogg">
														Your browser does not support the audio element.
													</audio> 
												</td>
											</tr>
											<tr>
												<td>
													<h4>
														ExampleQueries/wangchungNoise.wav
													</h4>
													</td>
												<td>
													<audio controls>
														<source src="HW5b_Shazam/ExampleQueries/wangchungNoise.wav" type="audio/ogg">
														Your browser does not support the audio element.
													</audio> 
												</td>
											</tr>

											<tr>
												<td colspan=2>
													For the following three queries below, the program should print out "Daniel Powter: Bad Day"
												</td>
											</tr>
											
											<tr>
												<td>
													<h4>
														ExampleQueries/baddayClean.wav
													</h4>
													</td>
												<td>
													<audio controls>
														<source src="HW5b_Shazam/ExampleQueries/baddayClean.wav" type="audio/ogg">
														Your browser does not support the audio element.
													</audio> 
												</td>
											</tr>
											<tr>
												<td>
													<h4>
														ExampleQueries/baddayLaptop.wav
													</h4>
													</td>
												<td>
													<audio controls>
														<source src="HW5b_Shazam/ExampleQueries/baddayLaptop.wav" type="audio/ogg">
														Your browser does not support the audio element.
													</audio> 
												</td>
											</tr>
											<tr>
												<td>
													<h4>
														ExampleQueries/baddayNoise.wav
													</h4>
													</td>
												<td>
													<audio controls>
														<source src="HW5b_Shazam/ExampleQueries/baddayNoise.wav" type="audio/ogg">
														Your browser does not support the audio element.
													</audio> 
												</td>
											</tr>

										


											<tr>
												<td colspan=2>
													For the following three queries below, the program should print out "Kanye West: Touch The Sky"
												</td>
											</tr>

											<tr>
												<td>
													<h4>
														ExampleQueries/skyClean.wav
													</h4>
													</td>
												<td>
													<audio controls>
														<source src="HW5b_Shazam/ExampleQueries/skyClean.wav" type="audio/ogg">
														Your browser does not support the audio element.
													</audio> 
												</td>
											</tr>
											<tr>
												<td>
													<h4>
														ExampleQueries/skyLaptop.wav
													</h4>
													</td>
												<td>
													<audio controls>
														<source src="HW5b_Shazam/ExampleQueries/skyLaptop.wav" type="audio/ogg">
														Your browser does not support the audio element.
													</audio> 
												</td>
											</tr>
											<tr>
												<td>
													<h4>
														ExampleQueries/skyNoise.wav
													</h4>
													</td>
												<td>
													<audio controls>
														<source src="HW5b_Shazam/ExampleQueries/skyNoise.wav" type="audio/ogg">
														Your browser does not support the audio element.
													</audio> 
												</td>
											</tr>
										</table>

										<p>
											To help debug your program, you should print out the maximum number of counts that you find in a bin for the song you've chosen.
										</p>

										<h3>Stress Testing</h3>
										<p>
											Once the above is working, you can try loading a larger database to see if it still works.  <a href = "https://drive.google.com/file/d/14BUUmi4gifjJtHJJ4bB9VZ2hSj48lJB3/view?usp=sharing">Click here</a> to download a .zip file with 266 songs, including the first 6 in this list, and update the query file to load more than the first 6 songs.  The problem technically gets harder, since there are more potential songs to confuse with in the database.  It will also take much longer to load the database and to setup the hash table.  But if this works, you'll know you have a robust system.
										</p>

										<h3>Going Further!</h3>
										<p>
											At this point, you have a fully functional basic implementation of audio fingerprinting for content-based music retrieval.  This is not required, but you should try it on your own music!  See if you can add a song to the database and query it with a clip.  Note that the parameters are setup so that the database is expecting single channel audio sampled at 22050hz in the .wav file format.  You can use <a href = "https://www.audacityteam.org/download/">Audacity</a> to do the conversion.  Questions to ask yourself as you go include:
											<ul>
												<li>
													How much audio does it seem like you need to do a robust identification?
												</li>
												<li>
													How noisy or distorted does can the audio be before the identification fails?
												</li>
												<li>
													Does this work on different versions of the song (e.g. cover songs)?  Why do you think that might be?
												</li>
											</ul>
										</p>

										



										
										
                                    
                                </div>
						</div>
					</div>

					<!--LaTeX in Javascript!-->
					<script src="../../../../jsMath/easy/load.js"></script>
					<!--Syntax highlighting in Javascript!-->
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shCore.js"></script>
					<script type="text/javascript" src="../../../syntaxhighlighter/scripts/shBrushJScript.js"></script>
                    <script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushCpp.js"></script>
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushXml.js"></script>
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushMatlabSimple.js"></script>
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushPython.js"></script>
					<link type="text/css" rel="stylesheet" href="../../../../syntaxhighlighter/styles/shCoreDefault.css"/>
					<script type="text/javascript">SyntaxHighlighter.all();</script>

<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">
							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
                                        <li>
											<span class="opener">General</span>
											<ul> 
												<li><a href = "../../index.html#overview">Overview</a></li>
												<li><a href = "../../index.html#logistics">Technology Logistics</a></li>
												<li><a href = "../../index.html#deliverables">Deliverables</a>
												<ul>
													<li><a href = "../../index.html#debugging">Debugging Principles</a>
												</ul>
												
												</li>
												<li><a href = "../../index.html#grading">Grading</a></li>
												<li><a href = "../../index.html#environment">Classroom Environment</a></li>
												<li><a href = "../../index.html#participation">Participation</a></li>
												<li><a href = "../../index.html#collaboration">Collaboration Policy</a></li>
												<li><a href = "../../index.html#other">Other Resources / Policies</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Software Environment</span>
											<ul>
												<li><a href = "../../../Modules/FreeRun">C++ Free Run in The Browser</a></li>
												<li><a href = "../../Software/index.html#vscode">Visual Studio Code</a></li>
												<li><a href = "../../Software/index.html#windows">Windows Setup Instructions</a></li>
												<li><a href = "../../Software/index.html#macos">Mac OS Setup Instructions</a></li>
												<li><a href = "../../Software/index.html#virtualbox">VirtualBox</a></li>
											</ul>
										</li>
										<li><a href = "../../index.html#schedule">Schedule</a></li>
                                        <li>
											<span class="opener">Assignments</span>
											<ul>
												<li><a href = "../../Assignments/HW0_Warmup">Homework 0: Software Test</a></li>
												<li><a href = "../../Assignments/HW1_VirtualCities">Homework 1: Virtual Cities</a>
												<ul>
													<li><a href = "../../Assignments/HW1_VirtualCities/ArtContest">Art Contest</a></li>
												</ul>
												</li>
												<li><a href = "../../Assignments/HW2_Steganography">Homework 2: Image Processing And Steganography</a></li>
												<li><a href = "../../Assignments/HW3_InvasiveSpecies">Homework 3: Invasive Species Polymorphism</a></li>
												<li><a href = "../../Assignments/HW4_LinkedListMaze/part1.html">Homework 4: Doubly Linked Lists</a></li>
												<li><a href = "../../Assignments/HW5_BasketballHashing">Homework 5: Basketball Hashing</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Labs</span>
											<ul>
												<li><a href = "../../Labs/Lab1_Holidays">Lab 1: HTML Holidays</a></li>
												<li><a href = "../../Labs/Lab2_BugHunt">Lab 2: C++ Bug Hunt</a></li>
												<li><a href = "../../Labs/Lab3_ShapesInheritance">Lab 3: Drawing Shapes with Aggregation And Inheritance</a></li>
												<li><a href = "../../Labs/Lab4_AbstractClassesSorting">Lab 4: Abstract Classes And Sorting</a></li>
												<li><a href = "../../Labs/Lab5_MyVector">Lab 5: My Vector (Dynamic Array ADT)</a></li>
												<li><a href = "../../Labs/Lab6_RecursiveDrawing">Lab 6: Recursive Drawing</a></li>
												<li><a href = "../../Labs/Lab7_HuffmanTrees">Lab 7: Huffman Trees</a></li>
											</ul>
										</li>
                                        <li>
											<span class="opener">Class Exercises / Pre-Class Work</span>
											<ul>
												<li><a href = "../../../Modules/CPPBasics/Video1">C++ Basics Module</a></li>
												<li><a href = "../../ClassExercises/Week1_CMD">Week 1: The Terminal And Files</a></li>
												<li><a href = "../../../Modules/PointerFundamentals/Exercise1">Pointer Fundamentals Module</a></li>
												<li><a href = "../../ClassExercises/Week2_3_PointerTricks">Week 2/3: C++ Pointers And Pitfalls</a></li>
												<li><a href = "../../ClassExercises/Week3_Pointers_Arrays">Week 3: C++ Pointers And Arrays</a></li>
												<li><a href = "../../ClassExercises/Week3_AudioFiltering">Week 3: Audio Filtering</a></li>
												<li><a href = "../../ClassExercises/Week3_2048">Week 3: Building The 2048 Game Together</a></li>
												<li><a href = "../../ClassExercises/Week4_DynMem">Week 4: Command Line Arguments and Dynamic 2D Arrays</a></li>
												<li><a href = "../../ClassExercises/Week4_BinaryDrills">Week 4: Binary Drills</a></li>
												<li><a href = "https://ursinus.instructure.com/courses/13764/quizzes/18074">Week 4: Binary/Hex Module</a></li>
												<li><a href = "../../ClassExercises/Week4_Binary_LFSR">Week 4: Notes on Bitwise Operators, Linear Feedback Shift Registers (LFSRs), and ASCII</a></li>
												<li><a href = "../../ClassExercises/Week4_Bits">Week 4: Bits And XOR Encryption</a></li>
												<li>
													<a href = "https://github.com/ursinus-cs174-s2022/Week5_ObjectBasics">Week 5: Object Basics Code</a>
												</li>
												<li>
													<a href = "https://ursinus-cs174-s2022.github.io/Modules/CppClasses/Video1">Week 5/6: C++ Classes And Inheritance Module</a>
												</li>
												<li>
													<a href = "https://ursinus-cs174-s2022.github.io/Modules/LinkedList/Video0">Week 8: Linked List Module</a>
												</li>
												<li>
													<a href = "https://github.com/ursinus-cs174-s2022/Week9_PrimMaze/">Week 9: Prim's Algorithm And Mazes</a>
												</li>
												<li><a href = "../../ClassExercises/Week10_Maps_Adventure">Week 10: STL Maps, Choose Your Own Adventure</a></li>
												<li>
													<a href = "https://ursinus-cs174-s2022.github.io/Modules/LinkedMap/Video1">Week 10: Linked Map Module</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week10_Hashing">Week 10: Hash Tables</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week11_Recursion">Week 11: Class Notes on Recursive Functions And Memoization</a>
												</li>
												<li>
													<a href = "https://ursinus-cs174-s2022.github.io/Modules/Ackermann/Exercise1">Week 11: Ackermann Module</a>
												</li>
												<li>
													<a href = "https://ursinus-cs174-s2022.github.io/Modules/MergeSort/Exercise">Week 12: Merge Sort Exercise</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week13_ImageFilters">Week 13: Function Pointers And Image Filters</a>
												</li>
											</ul>
										</li>
										<li>
											<span class="opener">Optional Fall 2020 Modules</span>
											<ul>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module1/Video1">Module 1: Classes Intro</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module2/Video1">Module 2: Hash Maps</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module3/Inheritance1">Module 3: Inheritance1</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module4/Video1">Module 4: Linked List Removal And Iterators</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module5/Video1">Module 5: Threads And Synchronization</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module6/Video1">Module 6: C++ Basics</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module7/Video1">Module 7: Addresses And Pointers</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module8/Exercise0">Module 8: Pointers Continued</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module9/Video1">Module 9: C++ Classes</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module10/Video1">Module 10: C++ Object References / Linked Lists</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module11/Video1">Module 11: ADTs / Linked Map</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module12/Video1">Module 12: C++ Inheritance</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module13/Video1">Module 13: Recursion And STL Vectors</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module14/Video1">Module 14: Recursion Part 2</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module15/Video1">Module 15: Binary Trees Intro</a></li>
												<li><a href = "https://ursinus-cs174-f2020.github.io/Modules/Module16/Video1">Module 16: Binary Trees Level And Depth</a></li>
											</ul>
										</li>
										<li>
											<a href = "../../style.html">Style Guide</a></li>
										</li>
									</ul>
								</nav>


							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">&copy; <a href = "http://www.ctralie.com">Christopher J. Tralie</a>. All rights reserved.  Contact chris.tralie@gmail.com. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
								</footer>

						</div>
					</div>

			</div>
			
            <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
            <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- End Sidebar !-->

<!-- Scripts -->
			<script src="../../assets/js/jquery.min.js"></script>
			<script src="../../assets/js/skel.min.js"></script>
			<script src="../../assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="../../assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="../../assets/js/main.js"></script>
<!-- End Scripts -->
	</